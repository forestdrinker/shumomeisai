# 5. 数据预处理与特征工程 (Data Preprocessing and Feature Engineering)

为了从原始的《与星共舞》(Dancing with the Stars) 历史数据中挖掘隐含的观众投票规律，我们将原始数据集进行了严格的清洗与结构化转换。本节详细阐述数据处理的流程、数学定义及特征构建方法。

## 5.1 数据来源与原始结构
原始数据文件 `2026_MCM_Problem_C_Data.csv` 包含 421 行记录，涵盖了第 1 季至第 34 季的所有参赛选手。原始数据采用“宽表”结构 (Wide Format)，每行代表一位选手，列中包含了每一周 (Week 1 - Week 11) 的详细评委打分。

## 5.2 数据清洗 (Data Cleaning)

### 5.2.1 异常值与缺失值处理
原始数据中存在 `0` 和 `N/A` 值，我们依据比赛规则进行了如下处理：
*   **零值处理**: 比赛规则中分数为 1-10 分，`0` 分通常表示选手在该周或之前已被淘汰。因此，我们在计算统计指标（如平均分、方差）时，将 `0` 视为**无效数据 (Null)** 并予以剔除，避免拉低平均值。
*   **评委缺席处理**: 部分周次（如早期赛季）只有 3 位评委，而后期常有 4 位。数据中以 `N/A` 表示第 4 位评委缺席。
    *   **处理方案**: 为了确保不同赛季分数的可比性，我们不使用“总分” (Total Score)，而是采用**动态平均分** (Dynamic Average Score)。
    *   设 $S_{i,w,j}$ 为第 $i$ 位选手在第 $w$ 周由第 $j$ 位评委给出的分数，$N_{i,w}$ 为当周有效评委数量，则该选手的当周原始平均分为：
      $$ \bar{S}_{i,w} = \frac{1}{N_{i,w}} \sum_{j=1}^{N_{i,w}} S_{i,w,j} $$

### 5.2.2 文本型数据量化
*   **行业分类 (Industry Mapping)**: 原始 `celebrity_industry` 字段包含大量非结构化描述（如 "Model", "Reality Star", "NBA Player"）。为了降低模型维度，我们运用关键词匹配算法将其聚类为 6 大核心类别：
    *   $C_{ind} \in \{ \text{Sports, Acting, Music, Reality TV, Media, Other} \}$
    *   例如，将 "NFL", "NBA", "Olympian" 统一映射为 **Sports**。
*   **地理信息二值化**: 鉴于该节目为美国版本，我们将选手分为“美国本土 (US)”与“国际 (International)”两类，构建二值变量 $Is\_US$。

## 5.3 数据重塑 (Data Reshaping)
为了捕捉选手表现的时间序列特征，我们将数据从“以选手为中心”转换为“以观测为中心”的**长表结构 (Long Format)**。
*   转换后，数据集的每一行代表一个独立的**观测样本 (Observation)**：$(Season, Week, Celebrity)$。
*   数据集规模从 421 行扩展为 2777 行有效观测记录。这一转换使我们能够进行周际回归分析 (Week-to-Week Regression)。

## 5.4 特征工程 (Feature Engineering)

为了克服跨赛季评分标准的通胀问题（Score Inflation），并量化选手的动态表现，我们构建了以下高级特征：

### 5.4.1 标准化得分 (Z-Score of Performance)
考虑到评委的打分尺度在不同赛季存在波动（例如，早期评委打分较严，后期较宽），直接比较绝对分数会引入偏差。我们在**“赛季-周次” (Season-Week)** 粒度上对分数进行标准化：
$$ Z_{i,w} = \frac{\bar{S}_{i,w} - \mu_{s,w}}{\sigma_{s,w}} $$
其中：
*   $\mu_{s,w}$ 为第 $s$ 赛季第 $w$ 周所有活跃选手的平均得分。
*   $\sigma_{s,w}$ 为对应的标准差。
*   $Z_{i,w}$ 反映了选手在该周相对于竞争对手的统治力，消除了赛季间的系统性偏差。

### 5.4.2 动态轨迹特征 (Performance Trajectory)
观众往往偏好具有“成长性”的选手。我们定义**得分轨迹**为本周与上周平均分的差值：
$$ \Delta S_{i,w} = \bar{S}_{i,w} - \bar{S}_{i,w-1} $$
*   $\Delta S_{i,w} > 0$ 表示选手在进步，可能会激发更多的观众投票热情。

### 5.4.3 评委排名 (Judge Rank)
我们计算了每位选手在当周评委评分中的排名 $R_{judge}$。该特征是反推观众投票的关键：
*   如果某选手 $R_{judge}$ 较低（如倒数第一）但最终未被淘汰 ($Is\_Safe = 1$)，则根据比赛规则（总分 = 评委分 + 观众分），该选手的观众投票必须足够高以抵消评委分的劣势。

## 5.5 数据清洗结果摘要
经过上述处理，我们构建了包含 2777 个样本的数据集 $\mathcal{D}$，核心变量定义如下表所示：

| 变量名           | 符号       | 类型 | 说明                          |
| :--------------- | :--------- | :--- | :---------------------------- |
| Season           | $s$        | 离散 | 赛季编号 (1-34)               |
| Week             | $w$        | 离散 | 比赛周次                      |
| Avg_Score        | $\bar{S}$  | 连续 | 评委原始平均分 (1-10)         |
| Z_Score          | $Z$        | 连续 | 赛季内标准化得分 (无量纲)     |
| Score_Trajectory | $\Delta S$ | 连续 | 较上周的分数变化              |
| Industry         | $C_{ind}$  | 分类 | 选手行业背景 (One-hot 编码)   |
| Is_Eliminated    | $Y$        | 二值 | 目标变量 (1=本周淘汰, 0=晋级) |
